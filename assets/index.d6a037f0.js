import{l as e,r as t,R as n,a as o,D as a,M as s,b as c}from"./vendor.d4b2581e.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();async function r(e,t,n){let o;const a=`https://oc2oa03354.execute-api.us-east-2.amazonaws.com/dev/v1${t}`;try{l(`api: ${e} ${a} :`,n);const t=await fetch(a,{method:e,mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});o=await t.json()}catch(s){l(`api: error ${e}ing to ${a}: `,s)}return o}function l(...e){console.log.apply(console,e)}async function i(e){let t;if("connected"==e.status){const n=await async function(e){l(`getFacebookUserId: token: ${e}`);const t=`https://graph.facebook.com/v12.0/me?access_token=${e}`;try{const e=await fetch(t);return await e.json()}catch(n){return void l("getFacebookUserId: caught error: ",n)}}(e.authResponse.accessToken);l("handleFacebookResponse: result from graphApi: ",n),t=await async function(e){l("recordFacebookLogin: recording on backend for: ",e);return await async function(e){const t={event:"login_facebook",access_token:e};return await r("POST","/login",t)}(e.accessToken)}(e.authResponse),403===t?(l("handleFacebookResponse: got 403 back from recordFacebookLogin"),t=void 0):l("handleFacebookResponse: recorded login, got this user back: ",t)}else l("handleFacebookResponse: FB.getLoginStatus response: ",e);return t}async function d(e){l("startFacebookBackup: starting backup on backend");const t=await async function(e){const t={event:"start_facebook_backup",access_token:e};return await r("POST","/start",t)}(e);return l("startFAcebookBackup: returned user: ",t),t}async function u(e,t){l(`getJobInfo: ${e} @ ${t}`);return await async function(e,t,n){const o={event:"get_document",collection:e,document_id:t,user_id:n};return await r("POST","/job",o)}("jobs",e,t)}let m,f;const g=e("pk_test_51JcGE3ICcbqfIBEKGJeEgNpeJRFAKpR4mnTrpHlzT4csjObyjVJTgyCdCj1lnLInWxe4Rhgyk0c7BAHm9VdZfCCW00pMBXkmUx");function p(){l("App.render()");const[e,c]=t.exports.useState("unknown"),p="login"===e||"complete"===e,b=!("unknown"===e||!(null==m?void 0:m.lastJobId)||"finished_success"!==(null==f?void 0:f.status)),y=async e=>{e?e.hasCredit?(l("updateStatusFromUser: --\x3e credit"),c("credit")):e.hasRunningJob?(f=await u(e.lastJobId,e._id),l("updateStatusFromUser: job is running - set currentJob to: ",f),"finished_success"===f.status?(l("updateStatusFromUser: --\x3e complete"),c("complete")):(l("updateStatusFromUser: --\x3e backing"),c("backing"))):(l("updateStatusFromUser: --\x3e login"),c("login")):(l("updateStatusFromUser: --\x3e unknown"),c("unknown"))};return t.exports.useEffect((()=>{l("App calling FB.getLoginStatus"),(async()=>{window.FB.getLoginStatus((async e=>{l("App FB.getLoginStatus returned ... now checking graphApi"),m=await i(e),y(m)}))})()}),[]),n.createElement("div",{className:"min-h-screen bg-gray-100 py-6 flex flex-col justify-center sm:py-12"},n.createElement("div",{className:"relative py-3 sm:max-w-xl sm:mx-auto"},n.createElement("div",{className:"bg-gradient-to-r from-blue-300 to-blue-600 shadow-lg sm:rounded-3xl py-2 my-2"},n.createElement("div",{className:"flex justify-center"},n.createElement("img",{src:"/assets/sms-logo.413c6a80.png",className:"h-16"}))),n.createElement("div",{className:"relative p-10 bg-white shadow-lg sm:rounded-3xl"},n.createElement("div",{className:"max-w-md mx-auto"},n.createElement("div",{className:"divide-y divide-gray-300"},n.createElement("div",{className:"py-4 text-base leading-6 space-y-4 text-gray-700 sm:text-lg sm:leading-7"},n.createElement("p",{className:"text-center"},"The EASIEST way to backup your social media photos."),n.createElement("p",{className:"text-center text-red-600 font-bold"},"Use them to make prints or digital albums."),n.createElement("p",{className:"text-center"},"A simple process ..."),n.createElement("p",{className:"text-center"},"Login, Purchase, Start, ",n.createElement("span",{className:"text-blue-400"},"(chill)"),", Download"),n.createElement("ul",{className:"list-disc space-y-2"},n.createElement("li",{className:"flex flex-col items-center"+("unknown"===e?"":" hidden")},n.createElement("button",{onClick:async()=>{l("handleFacebookLogin"),window.FB.login((e=>{l("handleFacebookLogin: response: ",e),i(e).then((e=>{m=e,y(m)}))}),{scope:"user_photos",return_scopes:!0})},type:"button",className:" w-48 inline-flex justify-center items-center px-4 py-2 border-2 border-blue-900 rounded-md shadow-sm text-sm font-medium text-black bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},n.createElement(o.SocialIcon,{network:"facebook",style:{height:24,width:24},fgColor:"#ffffff"}),n.createElement("span",{className:"mx-1"},"Login to Facebook"))),n.createElement("li",{className:"flex flex-col items-center"+(p?"":" hidden")},n.createElement("button",{onClick:()=>async function(e){if(l("collectPayment: for: ",e),e){const t=await g;t&&await t.redirectToCheckout({lineItems:[{price:"price_1JcGu0ICcbqfIBEKAvIkmxNL",quantity:1}],mode:"payment",clientReferenceId:e._id,successUrl:"https://savemystuff.net",cancelUrl:"https://savemystuff.net"})}else l("collectPayment: no user logged in - cannot redirect to payment screen")}(m),type:"button",className:" w-48 inline-flex justify-center items-center px-4 py-2 border-2 border-green-400 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Buy A Backup - $2")),n.createElement("li",{className:"flex flex-col items-center"+("credit"===e?"":" hidden")},n.createElement("button",{onClick:async()=>{l("handleStartButton"),m?(m=await d(m.lastLoginToken),y(m)):l("handleStartButton: unable to launch job - no loggedInUser")},type:"button",className:"w-48 inline-flex justify-center items-center px-4 py-2 border border-blue-400 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Start Your Backup")),n.createElement("li",{className:"flex flex-col items-center"+("backing"===e?"":" hidden")},n.createElement("span",{className:"text-blue-400"},"Started backing up @ ",(null==m?void 0:m.lastJobStartedAt)&&a.fromISO(m.lastJobStartedAt).toLocaleString(a.DATETIME_MED))),n.createElement("li",{className:"flex flex-col items-center"+("unknown"===e?" hidden":"")},n.createElement("button",{onClick:async()=>{l("handleFacebookLogout"),window.FB.logout((e=>{l("handleFacebookLogout: response: ",e),i(e).then((()=>{m=void 0,y(m)}))}))},type:"button",className:" w-48 inline-flex justify-center items-center px-4 py-2 border-2 border-blue-900 rounded-md shadow-sm text-sm font-medium text-black bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},n.createElement(o.SocialIcon,{network:"facebook",style:{height:24,width:24},fgColor:"#ffffff"}),n.createElement("span",{className:"mx-1"},"Logout"))))),n.createElement("div",{className:"py-4 text-base leading-6 space-y-4 text-gray-700 sm:text-lg sm:leading-7"},n.createElement("li",{className:"flex flex-col items-center"+(b?"":" hidden")},n.createElement("p",{className:"text-black py-1"},"Backup Result from ",(null==m?void 0:m.lastJobStartedAt)&&a.fromISO(m.lastJobStartedAt).toLocaleString(a.DATETIME_MED)),n.createElement("button",{onClick:async()=>{if(l("handleDownloadButton"),m){const e=await async function(e,t){const n={event:"get_download_link",job_id:e,user_id:t};return await r("POST","/link",n)}(m.lastJobId,m._id);l(`handleDownloadButton: got link: ${null==e?void 0:e.link}`);const t=`fbphotos_${a.fromISO(m.lastJobStartedAt).toFormat("yMMdd-HHmm")}.zip`;!function(e,t){l(`downloading: ${t} from ${e}`);const n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e.link,t)}},type:"button",className:"w-48 inline-flex justify-center items-center px-4 py-2 border-2 border-blue-500 rounded-md shadow-sm text-sm font-medium text-black bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Download Results"))),n.createElement("div",{className:"py-4 text-base leading-6  text-gray-700 sm:text-lg sm:leading-7 flex flex-row items-center justify-center"},n.createElement("p",null,"Any questions?"),n.createElement(s,{className:"px-1 w-8 h-8"}),n.createElement("a",{className:"text-blue-500 font-bold inline",href:"info@savemystuff.net"},"Email Us")))))))}c.render(n.createElement(n.StrictMode,null,n.createElement(p,null)),document.getElementById("root"));

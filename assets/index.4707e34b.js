import{l as e,r as t,R as n,D as a,M as o,a as s}from"./vendor.897297c6.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();async function c(e,t,n){let a;const o=`https://oc2oa03354.execute-api.us-east-2.amazonaws.com/dev/v1${t}`;try{r(`api: ${e} ${o} :`,n);const t=await fetch(o,{method:e,mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});a=await t.json()}catch(s){r(`api: error ${e}ing to ${o}: `,s)}return a}function r(...e){console.log.apply(console,e)}async function l(e){let t;if("connected"==e.status){const n=await async function(e){r(`getFacebookUserId: token: ${e}`);const t=`https://graph.facebook.com/v12.0/me?access_token=${e}`;try{const e=await fetch(t);return await e.json()}catch(n){return void r("getFacebookUserId: caught error: ",n)}}(e.authResponse.accessToken);r("handleFacebookResponse: result from graphApi: ",n),t=await async function(e){r("recordFacebookLogin: recording on backend for: ",e);return await async function(e){const t={event:"login_facebook",access_token:e};return await c("POST","/login",t)}(e.accessToken)}(e.authResponse),403===t?(r("handleFacebookResponse: got 403 back from recordFacebookLogin"),t=void 0):r("handleFacebookResponse: recorded login, got this user back: ",t)}else r("handleFacebookResponse: FB.getLoginStatus response: ",e);return t}async function i(e){r("startFacebookBackup: starting backup on backend");const t=await async function(e){const t={event:"start_facebook_backup",access_token:e};return await c("POST","/start",t)}(e);return r("startFAcebookBackup: returned user: ",t),t}async function d(e,t){r(`getJobInfo: ${e} @ ${t}`);return await async function(e,t,n){const a={event:"get_document",collection:e,document_id:t,user_id:n};return await c("POST","/job",a)}("jobs",e,t)}let u,m;const f=e("pk_test_51JcGE3ICcbqfIBEKGJeEgNpeJRFAKpR4mnTrpHlzT4csjObyjVJTgyCdCj1lnLInWxe4Rhgyk0c7BAHm9VdZfCCW00pMBXkmUx");function g(){r("App.render()");const[e,s]=t.exports.useState("unknown"),g="login"===e||"complete"===e,p=!("unknown"===e||!(null==u?void 0:u.lastJobId)),b=async e=>{e?e.hasCredit?(r("updateStatusFromUser: --\x3e credit"),s("credit")):e.hasRunningJob?(m=await d(e.lastJobId,e._id),r("updateStatusFromUser: job is running - set currentJob to: ",m),"finished_success"===m.status?(r("updateStatusFromUser: --\x3e complete"),s("complete")):(r("updateStatusFromUser: --\x3e backing"),s("backing"))):(r("updateStatusFromUser: --\x3e login"),s("login")):(r("updateStatusFromUser: --\x3e unknown"),s("unknown"))};return t.exports.useEffect((()=>{r("App calling FB.getLoginStatus"),(async()=>{window.FB.getLoginStatus((async e=>{r("App FB.getLoginStatus returned ... now checking graphApi"),u=await l(e),b(u)}))})()}),[]),n.createElement("div",{className:"min-h-screen bg-gray-100 py-6 flex flex-col justify-center sm:py-12"},n.createElement("div",{className:"relative py-3 sm:max-w-xl sm:mx-auto"},n.createElement("div",{className:"bg-gradient-to-r from-blue-300 to-blue-600 shadow-lg sm:rounded-3xl py-2 my-2"},n.createElement("div",{className:"flex justify-center"},n.createElement("img",{src:"/assets/sms-logo.413c6a80.png",className:"h-16"}))),n.createElement("div",{className:"relative p-10 bg-white shadow-lg sm:rounded-3xl"},n.createElement("div",{className:"max-w-md mx-auto"},n.createElement("div",{className:"divide-y divide-gray-300"},n.createElement("div",{className:"py-4 text-base leading-6 space-y-4 text-gray-700 sm:text-lg sm:leading-7"},n.createElement("p",{className:"text-center"},"The EASIEST way to backup your social media photos."),n.createElement("p",{className:"text-center text-red-600 font-bold"},"Use them to make prints or digital albums."),n.createElement("p",{className:"text-center"},"A simple process ..."),n.createElement("p",{className:"text-center"},"Login, Purchase, Start, ",n.createElement("span",{className:"text-blue-400"},"(chill)"),", Download"),n.createElement("ul",{className:"list-disc space-y-2"},n.createElement("li",{className:"flex flex-col items-center"+("unknown"===e?"":" hidden")},n.createElement("div",{className:"fb-login-button","data-width":"","data-size":"large","data-button-type":"continue_with","data-layout":"default","data-auto-logout-link":"false","data-use-continue-as":"true"})),n.createElement("li",{className:"flex flex-col items-center"+(g?"":" hidden")},n.createElement("button",{onClick:()=>async function(e){if(r("collectPayment: for: ",e),e){const t=await f;t&&await t.redirectToCheckout({lineItems:[{price:"price_1JcGu0ICcbqfIBEKAvIkmxNL",quantity:1}],mode:"payment",clientReferenceId:e._id,successUrl:"https://savemystuff.net",cancelUrl:"https://savemystuff.net"})}else r("collectPayment: no user logged in - cannot redirect to payment screen")}(u),type:"button",className:" w-48 inline-flex justify-center items-center px-4 py-2 border-2 border-green-400 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Buy A Backup - $2")),n.createElement("li",{className:"flex flex-col items-center"+("credit"===e?"":" hidden")},n.createElement("button",{onClick:async()=>{r("handleStartButton"),u?(u=await i(u.lastLoginToken),b(u)):r("handleStartButton: unable to launch job - no loggedInUser")},type:"button",className:"w-48 inline-flex justify-center items-center px-4 py-2 border border-blue-400 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Start Your Backup")),n.createElement("li",{className:"flex flex-col items-center"+("backing"===e?"":" hidden")},n.createElement("span",{className:"text-blue-400"},"(chill)Started backing up @ ",(null==u?void 0:u.lastJobStartedAt)&&a.fromISO(u.lastJobStartedAt).toLocaleString(a.DATETIME_MED))),n.createElement("li",{className:"flex flex-col items-center"+(p?"":" hidden")},n.createElement("p",{className:"text-blue-400"},"Backup Result from ",(null==u?void 0:u.lastJobStartedAt)&&a.fromISO(u.lastJobStartedAt).toLocaleString(a.DATETIME_MED)),n.createElement("button",{onClick:async()=>{if(r("handleDownloadButton"),u){const e=await async function(e,t){const n={event:"get_download_link",job_id:e,user_id:t};return await c("POST","/link",n)}(u.lastJobId,u._id);r(`handleDownloadButton: got link: ${null==e?void 0:e.link}`);const t=`fbphotos_${a.fromISO(u.lastJobStartedAt).toFormat("yMMdd-HHmm")}.zip`;!function(e,t){r(`downloading: ${t} from ${e}`);const n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e.link,t)}},type:"button",className:"w-48 inline-flex justify-center items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-300 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Download Results")))),n.createElement("div",{className:"py-4 text-base leading-6  text-gray-700 sm:text-lg sm:leading-7 flex flex-row items-center justify-center"},n.createElement("p",null,"Any questions?"),n.createElement(o,{className:"px-1 w-8 h-8"}),n.createElement("a",{className:"text-blue-500 font-bold inline",href:"info@savemystuff.net"},"Email Us")))))))}s.render(n.createElement(n.StrictMode,null,n.createElement(g,null)),document.getElementById("root"));
